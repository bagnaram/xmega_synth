\hypertarget{keyboard_8c}{\section{keyboard/keyboard.c File Reference}
\label{keyboard_8c}\index{keyboard/keyboard.\-c@{keyboard/keyboard.\-c}}
}
{\ttfamily \#include \char`\"{}keyboard.\-h\char`\"{}}\\*
Include dependency graph for keyboard.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{keyboard_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{keyboard_8c_aeaf658ec243c86cedf6953943cacfa6c}{I\-S\-R} (P\-O\-R\-T\-F\-\_\-\-I\-N\-T1\-\_\-vect)
\begin{DoxyCompactList}\small\item\em Interrupt service routine for P\-O\-R\-T\-F. \end{DoxyCompactList}\item 
void \hyperlink{keyboard_8c_a12e80295bc304d42073ca130ff9a9500}{keyboard\-\_\-clock\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Initialiaze the clock to be 32\-Mhz. \end{DoxyCompactList}\item 
char \hyperlink{keyboard_8c_a0d8cfaf4d0e76cc5ecb09681adac3ef3}{keyboard\-\_\-render\-\_\-scan\-\_\-code} (uint8\-\_\-t data)
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_a7060d775150320db57889d2659bb6284}{keyboard\-\_\-read\-\_\-char} ()
\item 
void \hyperlink{keyboard_8c_aaeb4e4a3c4813ee1efc6b98bba9ec781}{keyboard\-\_\-init} ()
\begin{DoxyCompactList}\small\item\em This function initialiazes the ports on the P\-S/2 port Sets up timer interrupts for P\-O\-R\-T\-F. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char \hyperlink{keyboard_8c_ab51051b9acefccd468cdbd407c826fb0}{st} \mbox{[}20\mbox{]} =\char`\"{} \char`\"{}
\item 
volatile uint8\-\_\-t \hyperlink{keyboard_8c_ac6271798c92bfb95295c0eb43ad1f8a5}{kbd\-\_\-data}
\item 
volatile uint8\-\_\-t \hyperlink{keyboard_8c_a2076b44e14575d889c509d93df4e3ad2}{char\-\_\-waiting}
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_a4962713018c207c653a60b1ec9554b52}{started}
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_a3638028601cbd7e3383db0fe214e6c9b}{bit\-\_\-count}
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_a28ac534ad4b71a6f265826746888e43e}{shift}
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_ade2e2c50ad5f47ed8904d123c732d5a6}{caps\-\_\-lock}
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_acd53bef429b3afe798b7228806e6e294}{extended}
\item 
uint8\-\_\-t \hyperlink{keyboard_8c_add4c887e71286ff439152f14a491d84b}{release}
\item 
const char keymap\mbox{[}128\mbox{]} \hyperlink{keyboard_8c_af786df5d8361570448476c5ec3d9e6e2}{P\-R\-O\-G\-M\-E\-M} = \{'?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','q','1','?','?','?','z','s','a','w','2','?','?','c','x','d','e','4','3','?','?',' ','v','f','t','r','5','?','?','n','b','h','\hyperlink{list_8c_a71867e609034d4dbd6d0ad8d84540e59}{g}','y','6','?','?','?','m','j','u','7','8','?','?','?','k','i','o','0','9','?','?','?','?','l','?','p','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?'\}
\begin{DoxyCompactList}\small\item\em include for P\-S/2 to A\-S\-C\-I\-I mapping \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{keyboard_8c_aeaf658ec243c86cedf6953943cacfa6c}{\index{keyboard.\-c@{keyboard.\-c}!I\-S\-R@{I\-S\-R}}
\index{I\-S\-R@{I\-S\-R}!keyboard.c@{keyboard.\-c}}
\subsubsection[{I\-S\-R}]{\setlength{\rightskip}{0pt plus 5cm}I\-S\-R (
\begin{DoxyParamCaption}
\item[{P\-O\-R\-T\-F\-\_\-\-I\-N\-T1\-\_\-vect}]{}
\end{DoxyParamCaption}
)}}\label{keyboard_8c_aeaf658ec243c86cedf6953943cacfa6c}


Interrupt service routine for P\-O\-R\-T\-F. 

Triggered when P\-O\-R\-T\-F pin 2 transitions from high to low. Handles P\-S/2 clock input and reads data in bit by bit. 

References bit\-\_\-count, char\-\_\-waiting, K\-B\-\_\-\-C\-L\-K, K\-B\-\_\-\-D\-A\-T\-A, K\-B\-\_\-\-P\-O\-R\-T, kbd\-\_\-data, release, shift, and started.

\hypertarget{keyboard_8c_a12e80295bc304d42073ca130ff9a9500}{\index{keyboard.\-c@{keyboard.\-c}!keyboard\-\_\-clock\-\_\-init@{keyboard\-\_\-clock\-\_\-init}}
\index{keyboard\-\_\-clock\-\_\-init@{keyboard\-\_\-clock\-\_\-init}!keyboard.c@{keyboard.\-c}}
\subsubsection[{keyboard\-\_\-clock\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void keyboard\-\_\-clock\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{keyboard_8c_a12e80295bc304d42073ca130ff9a9500}


Initialiaze the clock to be 32\-Mhz. 

\hypertarget{keyboard_8c_aaeb4e4a3c4813ee1efc6b98bba9ec781}{\index{keyboard.\-c@{keyboard.\-c}!keyboard\-\_\-init@{keyboard\-\_\-init}}
\index{keyboard\-\_\-init@{keyboard\-\_\-init}!keyboard.c@{keyboard.\-c}}
\subsubsection[{keyboard\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void keyboard\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{keyboard_8c_aaeb4e4a3c4813ee1efc6b98bba9ec781}


This function initialiazes the ports on the P\-S/2 port Sets up timer interrupts for P\-O\-R\-T\-F. 

Make this interrupt medium level so it is higher priority than the timer interrupts!

References bit\-\_\-count, K\-B\-\_\-\-C\-L\-K, K\-B\-\_\-\-D\-A\-T\-A, K\-B\-\_\-\-P\-O\-R\-T, kbd\-\_\-data, and started.



Referenced by main().

\hypertarget{keyboard_8c_a7060d775150320db57889d2659bb6284}{\index{keyboard.\-c@{keyboard.\-c}!keyboard\-\_\-read\-\_\-char@{keyboard\-\_\-read\-\_\-char}}
\index{keyboard\-\_\-read\-\_\-char@{keyboard\-\_\-read\-\_\-char}!keyboard.c@{keyboard.\-c}}
\subsubsection[{keyboard\-\_\-read\-\_\-char}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t keyboard\-\_\-read\-\_\-char (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{keyboard_8c_a7060d775150320db57889d2659bb6284}


References char\-\_\-waiting, kbd\-\_\-data, and release.



Referenced by main().

\hypertarget{keyboard_8c_a0d8cfaf4d0e76cc5ecb09681adac3ef3}{\index{keyboard.\-c@{keyboard.\-c}!keyboard\-\_\-render\-\_\-scan\-\_\-code@{keyboard\-\_\-render\-\_\-scan\-\_\-code}}
\index{keyboard\-\_\-render\-\_\-scan\-\_\-code@{keyboard\-\_\-render\-\_\-scan\-\_\-code}!keyboard.c@{keyboard.\-c}}
\subsubsection[{keyboard\-\_\-render\-\_\-scan\-\_\-code}]{\setlength{\rightskip}{0pt plus 5cm}char keyboard\-\_\-render\-\_\-scan\-\_\-code (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{keyboard_8c_a0d8cfaf4d0e76cc5ecb09681adac3ef3}


References shift.



Referenced by main().



\subsection{Variable Documentation}
\hypertarget{keyboard_8c_a3638028601cbd7e3383db0fe214e6c9b}{\index{keyboard.\-c@{keyboard.\-c}!bit\-\_\-count@{bit\-\_\-count}}
\index{bit\-\_\-count@{bit\-\_\-count}!keyboard.c@{keyboard.\-c}}
\subsubsection[{bit\-\_\-count}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t bit\-\_\-count}}\label{keyboard_8c_a3638028601cbd7e3383db0fe214e6c9b}


Referenced by I\-S\-R(), and keyboard\-\_\-init().

\hypertarget{keyboard_8c_ade2e2c50ad5f47ed8904d123c732d5a6}{\index{keyboard.\-c@{keyboard.\-c}!caps\-\_\-lock@{caps\-\_\-lock}}
\index{caps\-\_\-lock@{caps\-\_\-lock}!keyboard.c@{keyboard.\-c}}
\subsubsection[{caps\-\_\-lock}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t caps\-\_\-lock}}\label{keyboard_8c_ade2e2c50ad5f47ed8904d123c732d5a6}
\hypertarget{keyboard_8c_a2076b44e14575d889c509d93df4e3ad2}{\index{keyboard.\-c@{keyboard.\-c}!char\-\_\-waiting@{char\-\_\-waiting}}
\index{char\-\_\-waiting@{char\-\_\-waiting}!keyboard.c@{keyboard.\-c}}
\subsubsection[{char\-\_\-waiting}]{\setlength{\rightskip}{0pt plus 5cm}volatile uint8\-\_\-t char\-\_\-waiting}}\label{keyboard_8c_a2076b44e14575d889c509d93df4e3ad2}


Referenced by I\-S\-R(), keyboard\-\_\-read\-\_\-char(), and main().

\hypertarget{keyboard_8c_acd53bef429b3afe798b7228806e6e294}{\index{keyboard.\-c@{keyboard.\-c}!extended@{extended}}
\index{extended@{extended}!keyboard.c@{keyboard.\-c}}
\subsubsection[{extended}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t extended}}\label{keyboard_8c_acd53bef429b3afe798b7228806e6e294}
\hypertarget{keyboard_8c_ac6271798c92bfb95295c0eb43ad1f8a5}{\index{keyboard.\-c@{keyboard.\-c}!kbd\-\_\-data@{kbd\-\_\-data}}
\index{kbd\-\_\-data@{kbd\-\_\-data}!keyboard.c@{keyboard.\-c}}
\subsubsection[{kbd\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}volatile uint8\-\_\-t kbd\-\_\-data}}\label{keyboard_8c_ac6271798c92bfb95295c0eb43ad1f8a5}


Referenced by I\-S\-R(), keyboard\-\_\-init(), and keyboard\-\_\-read\-\_\-char().

\hypertarget{keyboard_8c_af786df5d8361570448476c5ec3d9e6e2}{\index{keyboard.\-c@{keyboard.\-c}!P\-R\-O\-G\-M\-E\-M@{P\-R\-O\-G\-M\-E\-M}}
\index{P\-R\-O\-G\-M\-E\-M@{P\-R\-O\-G\-M\-E\-M}!keyboard.c@{keyboard.\-c}}
\subsubsection[{P\-R\-O\-G\-M\-E\-M}]{\setlength{\rightskip}{0pt plus 5cm}const char keymap \mbox{[}128\mbox{]} P\-R\-O\-G\-M\-E\-M = \{'?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','q','1','?','?','?','z','s','a','w','2','?','?','c','x','d','e','4','3','?','?',' ','v','f','t','r','5','?','?','n','b','h','{\bf g}','y','6','?','?','?','m','j','u','7','8','?','?','?','k','i','o','0','9','?','?','?','?','l','?','p','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?'\}}}\label{keyboard_8c_af786df5d8361570448476c5ec3d9e6e2}


include for P\-S/2 to A\-S\-C\-I\-I mapping 

\hypertarget{keyboard_8c_add4c887e71286ff439152f14a491d84b}{\index{keyboard.\-c@{keyboard.\-c}!release@{release}}
\index{release@{release}!keyboard.c@{keyboard.\-c}}
\subsubsection[{release}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t release}}\label{keyboard_8c_add4c887e71286ff439152f14a491d84b}


Referenced by I\-S\-R(), keyboard\-\_\-read\-\_\-char(), and main().

\hypertarget{keyboard_8c_a28ac534ad4b71a6f265826746888e43e}{\index{keyboard.\-c@{keyboard.\-c}!shift@{shift}}
\index{shift@{shift}!keyboard.c@{keyboard.\-c}}
\subsubsection[{shift}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t shift}}\label{keyboard_8c_a28ac534ad4b71a6f265826746888e43e}


Referenced by I\-S\-R(), and keyboard\-\_\-render\-\_\-scan\-\_\-code().

\hypertarget{keyboard_8c_ab51051b9acefccd468cdbd407c826fb0}{\index{keyboard.\-c@{keyboard.\-c}!st@{st}}
\index{st@{st}!keyboard.c@{keyboard.\-c}}
\subsubsection[{st}]{\setlength{\rightskip}{0pt plus 5cm}char st\mbox{[}20\mbox{]} =\char`\"{} \char`\"{}}}\label{keyboard_8c_ab51051b9acefccd468cdbd407c826fb0}
\hypertarget{keyboard_8c_a4962713018c207c653a60b1ec9554b52}{\index{keyboard.\-c@{keyboard.\-c}!started@{started}}
\index{started@{started}!keyboard.c@{keyboard.\-c}}
\subsubsection[{started}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t started}}\label{keyboard_8c_a4962713018c207c653a60b1ec9554b52}


Referenced by I\-S\-R(), and keyboard\-\_\-init().

